import json
import re
import ast

response = """[{"Cronulla": "Location"}, {"Player": "Person"}, {"Pipeline Pro": "Organization"}]"""
punc_zh2en = {'，': ',', '。': '.', '：': ':'}  # transfer Chinese punctuation into English punctuation
response_punctransed = response.translate(str.maketrans(punc_zh2en))
response_punctransed = response_punctransed.replace("\n", "")
matched_list = re.findall(r'\[(.*?)\]', response_punctransed)  # matching
print(matched_list)
print(matched_list[0])
print(response)
print('-------')
b = {'idx': 18,
     'sentence': 'They are also scheduled to play Roskilde , Rock am Ring , Pinkpop , Give It A Name Festival and Download .',
     'label': "{'Rock am Ring': 'Miscellaneous', 'Pinkpop': 'Miscellaneous', 'Roskilde': 'Miscellaneous', 'Download': 'Miscellaneous', 'Give It A Name Festival': 'Miscellaneous'}",
     'stage1': 'Given target sentence : They are also scheduled to play Roskilde , Rock am Ring , Pinkpop , Give It A Name Festival and Download .\nGiven entity label set: [\'Organization\', \'Person\', \'Location\', \'Miscellaneous\']\nRecognize the named entities for the target sentence.\nSimply provide answer in the following format: [{\\"Entity Name\\": \\"Entity Label\\"}]. If there is no entity in the text, return the following empty list: []',
     'response1': '[{"Roskilde": "Location"}, {"Rock am Ring": "Location"}, {"Pinkpop": "Location"}, {"Give It A Name Festival": "Organization"}, {"Download": "Organization"}]',
     'stage2': 'Given target sentence : They are also scheduled to play Roskilde , Rock am Ring , Pinkpop , Give It A Name Festival and Download .\nGiven entity types that may be included in this target sentence [\'Location\', \'Organization\']\nHere provide some examples and the corresponding entity labels.\nBased on the entity labels in the target sentence, please predict the helpfulness scores of each sentence, which indicates the degree to which providing the current example can aid in extracting named entities from the target_sentence. The score ranges from 1 to 5, with 1 being the least helpful and 5 being the most helpful.\nSimply provide answer in the following format: [{"Sentence id": "helpfulness score"}]####\nExample1: Prior to 2001 , the event was held in Kuala Lumpur .\nLabel: [{\'Kuala Lumpur\': \'Location\'}]\n####\nExample2: The album was produced by Josh Abraham , whose producing credits also include Orgy , Velvet Revolver , and Linkin Park .\nLabel: [{\'Josh Abraham\': \'Person\'}, {\'Orgy\': \'Organization\'}, {\'Velvet Revolver\': \'Organization\'}, {\'Linkin Park\': \'Organization\'}]\n####\nExample3: In addition to a number of original songs , the album includes a cover of Siouxsie \'s Cities in Dust .\nLabel: [{\'Siouxsie\': \'Person\'}]\n####\nExample4: The 2007 event is being held from September 10 till September 16 .\nLabel: [{\'2007 event\': \'Miscellaneous\'}, {\'September 10\': \'Miscellaneous\'}, {\'September 16\': \'Miscellaneous\'}]\n####\nExample5: The album cover \'s artwork was provided by Mattias Noren .\nLabel: [{\'Mattias Noren\': \'Person\'}]\n####\nExample6: According to an interview from Virgin Records , the band \'s name\nLabel: [{\'Virgin Records\': \'Organization\'}]\n####\nExample7: Dark Room Notes are a four-piece electro / synthpop band based in Dublin , Ireland .\nLabel: [{\'Dark Room Notes\': \'Organization\'}, {\'Dublin\': \'Location\'}, {\'Ireland\': \'Location\'}]\n####\nExample8: He is the lead guitarist and songwriter of the band Gigi .\nLabel: [{\'Gigi\': \'Organization\'}]\n####\nExample9: They performed their first gig in Galway in December 2006 .\nLabel: [{\'Galway\': \'Location\'}]\n####\nExample10: Things began to speed up quickly , and Matt Wachter later joined the band as bassist and keyboard player .\nLabel: [{\'Matt Wachter\': \'Person\'}]\n####\nExample11: In October , the band began their " Welcome to the Universe " tour , sponsored by MTV2 .\nLabel: [{\'MTV2\': \'Organization\'}]\n####\nExample12: As a young pianist , he toured Europe performing in many capitals .\nLabel: [{\'Europe\': \'Location\'}]\n####\nExample13: Circuit Park Zandvoort played host to the first race in the 2006/07 season of A1 Grand Prix from 29 September - 1 October 2006 .\nLabel: [{\'Circuit Park Zandvoort\': \'Location\'}, {\'A1 Grand Prix\': \'Organization\'}]\n####\nExample14: To fully appreciate the importance of this cultural scene , see the entries for Moses Mendelssohn , Gotthold Ephraim Lessing , Friedrich Schlegel , Germaine de Staë , Felix Mendelssohn , Ludwi Tieck , Novalis , and others .\nLabel: [{\'Moses Mendelssohn\': \'Person\'}, {\'Gotthold Ephraim Lessing\': \'Person\'}, {\'Friedrich Schlegel\': \'Person\'}, {\'Germaine de Staë\': \'Person\'}, {\'Felix Mendelssohn\': \'Person\'}, {\'Ludwi Tieck\': \'Person\'}, {\'Novalis\': \'Person\'}]\n####\nExample15: As of Spring 2007 , the band is supporting The Used as a part of the " Taste of Chaos " tour and have scheduled a string of dates in Europe supporting Linkin Park .\nLabel: [{\'Spring 2007\': \'Miscellaneous\'}, {\'The Used\': \'Organization\'}, {\'Taste of Chaos\': \'Miscellaneous\'}, {\'Europe\': \'Location\'}, {\'Linkin Park\': \'Organization\'}]\n####\nExample16: Darkness Death Doom is the sixth album by Runemagick .\nLabel: [{\'Runemagick\': \'Organization\'}]\n',
     'response2': '[{"Example1": "3"}, {"Example2": "5"}, {"Example3": "1"}, {"Example4": "2"}, {"Example5": "1"}, {"Example6": "3"}, {"Example7": "5"}, {"Example8": "4"}, {"Example9": "3"}, {"Example10": "1"}, {"Example11": "4"}, {"Example12": "3"}, {"Example13": "5"}, {"Example14": "1"}, {"Example15": "5"}, {"Example16": "4"}]',
     'stage3': 'Given target sentence : They are also scheduled to play Roskilde , Rock am Ring , Pinkpop , Give It A Name Festival and Download .\nGiven entity label set: [\'Organization\', \'Person\', \'Location\', \'Miscellaneous\']\nAnother agent identified the following named entities in the target sentence：{\'Roskilde\': \'Location\', \'Rock am Ring\': \'Location\', \'Pinkpop\': \'Location\', \'Give It A Name Festival\': \'Organization\', \'Download\': \'Organization\'}\nHere provide some examples and the corresponding entity labels.\nThe helpfulness scores of each sentence are also provided, which indicates the degree to which providing the current example can aid in extracting named entities from the target_sentence.\nBased on the above information, recognize the named entities for the target sentence.\nSimply provide answer in the following format: [{\\"Entity Name\\": \\"Entity Label\\"}]. If there is no entity in the text, return the following empty list: []\n####\nSentence: Prior to 2001 , the event was held in Kuala Lumpur .\nLabel: [{\'Kuala Lumpur\': \'Location\'}]\nHelpfulness score: 3\n####\nSentence: The album was produced by Josh Abraham , whose producing credits also include Orgy , Velvet Revolver , and Linkin Park .\nLabel: [{\'Josh Abraham\': \'Person\'}, {\'Orgy\': \'Organization\'}, {\'Velvet Revolver\': \'Organization\'}, {\'Linkin Park\': \'Organization\'}]\nHelpfulness score: 5\n####\nSentence: In addition to a number of original songs , the album includes a cover of Siouxsie \'s Cities in Dust .\nLabel: [{\'Siouxsie\': \'Person\'}]\nHelpfulness score: 1\n####\nSentence: The 2007 event is being held from September 10 till September 16 .\nLabel: [{\'2007 event\': \'Miscellaneous\'}, {\'September 10\': \'Miscellaneous\'}, {\'September 16\': \'Miscellaneous\'}]\nHelpfulness score: 2\n####\nSentence: The album cover \'s artwork was provided by Mattias Noren .\nLabel: [{\'Mattias Noren\': \'Person\'}]\nHelpfulness score: 1\n####\nSentence: According to an interview from Virgin Records , the band \'s name\nLabel: [{\'Virgin Records\': \'Organization\'}]\nHelpfulness score: 3\n####\nSentence: Dark Room Notes are a four-piece electro / synthpop band based in Dublin , Ireland .\nLabel: [{\'Dark Room Notes\': \'Organization\'}, {\'Dublin\': \'Location\'}, {\'Ireland\': \'Location\'}]\nHelpfulness score: 5\n####\nSentence: He is the lead guitarist and songwriter of the band Gigi .\nLabel: [{\'Gigi\': \'Organization\'}]\nHelpfulness score: 4\n####\nSentence: They performed their first gig in Galway in December 2006 .\nLabel: [{\'Galway\': \'Location\'}]\nHelpfulness score: 3\n####\nSentence: Things began to speed up quickly , and Matt Wachter later joined the band as bassist and keyboard player .\nLabel: [{\'Matt Wachter\': \'Person\'}]\nHelpfulness score: 1\n####\nSentence: In October , the band began their " Welcome to the Universe " tour , sponsored by MTV2 .\nLabel: [{\'MTV2\': \'Organization\'}]\nHelpfulness score: 4\n####\nSentence: As a young pianist , he toured Europe performing in many capitals .\nLabel: [{\'Europe\': \'Location\'}]\nHelpfulness score: 3\n####\nSentence: Circuit Park Zandvoort played host to the first race in the 2006/07 season of A1 Grand Prix from 29 September - 1 October 2006 .\nLabel: [{\'Circuit Park Zandvoort\': \'Location\'}, {\'A1 Grand Prix\': \'Organization\'}]\nHelpfulness score: 5\n####\nSentence: To fully appreciate the importance of this cultural scene , see the entries for Moses Mendelssohn , Gotthold Ephraim Lessing , Friedrich Schlegel , Germaine de Staë , Felix Mendelssohn , Ludwi Tieck , Novalis , and others .\nLabel: [{\'Moses Mendelssohn\': \'Person\'}, {\'Gotthold Ephraim Lessing\': \'Person\'}, {\'Friedrich Schlegel\': \'Person\'}, {\'Germaine de Staë\': \'Person\'}, {\'Felix Mendelssohn\': \'Person\'}, {\'Ludwi Tieck\': \'Person\'}, {\'Novalis\': \'Person\'}]\nHelpfulness score: 1\n####\nSentence: As of Spring 2007 , the band is supporting The Used as a part of the " Taste of Chaos " tour and have scheduled a string of dates in Europe supporting Linkin Park .\nLabel: [{\'Spring 2007\': \'Miscellaneous\'}, {\'The Used\': \'Organization\'}, {\'Taste of Chaos\': \'Miscellaneous\'}, {\'Europe\': \'Location\'}, {\'Linkin Park\': \'Organization\'}]\nHelpfulness score: 5\n####\nSentence: Darkness Death Doom is the sixth album by Runemagick .\nLabel: [{\'Runemagick\': \'Organization\'}]\nHelpfulness score: 4\n####\nSentence: They are also scheduled to play Roskilde , Rock am Ring , Pinkpop , Give It A Name Festival and Download .\nLabel:',
     'response3': '[{"Roskilde": "Location"}, {"Rock am Ring": "Location"}, {"Pinkpop": "Location"}, {"Give It A Name Festival": "Organization"}, {"Download": "Organization"}]',
     'prediction': {'Roskilde': 'Location', 'Rock am Ring': 'Location', 'Pinkpop': 'Location',
                    'Give It A Name Festival': 'Organization', 'Download': 'Organization'}}

print('b' * 100)
for k, v in b.items():
    print(k)
    print(v)
    print('-' * 30)
print('b' * 100)

c = {
    "idx": 0,
    "sentence": "UK Edition came with the OSC-DIS video , and most of the tracks were re-engineered .",
    "label": "{'OSC-DIS': 'Miscellaneous', 'UK': 'Location'}",
    "stage1": "Given target sentence : UK Edition came with the OSC-DIS video , and most of the tracks were re-engineered .\nGiven entity label set: ['Organization', 'Person', 'Location', 'Miscellaneous']\nRecognize the named entities for the target sentence.\nSimply provide answer in the following format: [{\\\"Entity Name\\\": \\\"Entity Label\\\"}]. If there is no entity in the text, return the following empty list: []",
    "stage2": "Given target sentence : UK Edition came with the OSC-DIS video , and most of the tracks were re-engineered .\nGiven entity types that may be included in this target sentence <ner_type>\nHere provide some examples and the corresponding entity labels.\nBased on the entity labels in the target sentence, please predict the helpfulness scores of each sentence, which indicates the degree to which providing the current example can aid in extracting named entities from the target_sentence. The score ranges from 1 to 5, with 1 being the least helpful and 5 being the most helpful.\nSimply provide answer in the following format: [{\"Sentence id\": \"helpfulness score\"}]####\nExample1: His parents were encouraged by a friend to develop the child 's musical talents and he studied classical piano in the United States .\nLabel: [{'United States': 'Location'}]\n####\nExample2: In this , he is often cited as being influenced by pianist Eddy Duchin .\nLabel: [{'Eddy Duchin': 'Person'}]\n####\nExample3: In addition to a number of original songs , the album includes a cover of Siouxsie 's Cities in Dust .\nLabel: [{'Siouxsie': 'Person'}]\n####\nExample4: The album 's title is an amalgamation of the words ' digital ' and ' analogue ' , two of the principal technologies that have been used in sound recording .\nLabel: [{'digital': 'Miscellaneous'}, {'analogue': 'Miscellaneous'}]\n####\nExample5: The album cover 's artwork was provided by Mattias Noren .\nLabel: [{'Mattias Noren': 'Person'}]\n####\nExample6: Dark Room Notes are a four-piece electro / synthpop band based in Dublin , Ireland .\nLabel: [{'Dark Room Notes': 'Organization'}, {'Dublin': 'Location'}, {'Ireland': 'Location'}]\n####\nExample7: Darkness Death Doom is the sixth album by Runemagick .\nLabel: [{'Runemagick': 'Organization'}]\n####\nExample8: After his naval discharge , Langejans took a job at Meyer Music in Holland , where he was trained in the intricacies of instrument repair and electronics .\nLabel: [{'Langejans': 'Person'}, {'Meyer Music': 'Organization'}, {'Holland': 'Location'}]\n####\nExample9: The album was produced by Josh Abraham , whose producing credits also include Orgy , Velvet Revolver , and Linkin Park .\nLabel: [{'Josh Abraham': 'Person'}, {'Orgy': 'Organization'}, {'Velvet Revolver': 'Organization'}, {'Linkin Park': 'Organization'}]\n####\nExample10: The appearance of locomotive # 7 was permanently changed by replacement of a smaller number plate on the front of the boiler .\nLabel: [{'locomotive # 7': 'Miscellaneous'}]\n####\nExample11: Things began to speed up quickly , and Matt Wachter later joined the band as bassist and keyboard player .\nLabel: [{'Matt Wachter': 'Person'}]\n####\nExample12: In 1971 , he began to design and build his own guitars , originally bearing the name Del's .\nLabel: [{\"Del's\": 'Organization'}]\n####\nExample13: They were supported on this tour by Head Automatica , The Receiving End of Sirens , Cobra Starship , and several other bands including Street Drum Corps .\nLabel: [{'Head Automatica': 'Organization'}, {'The Receiving End of Sirens': 'Organization'}, {'Cobra Starship': 'Organization'}, {'Street Drum Corps': 'Organization'}]\n####\nExample14: As a young pianist , he toured Europe performing in many capitals .\nLabel: [{'Europe': 'Location'}]\n####\nExample15: According to an interview from Virgin Records , the band 's name\nLabel: [{'Virgin Records': 'Organization'}]\n####\nExample16: The Langejans Dualette is a two sided guitar which was custom made for Thom Bresh .\nLabel: [{'Langejans Dualette': 'Miscellaneous'}, {'Thom Bresh': 'Person'}]\n",
    "stage3": "Given target sentence : UK Edition came with the OSC-DIS video , and most of the tracks were re-engineered .\nGiven entity label set: ['Organization', 'Person', 'Location', 'Miscellaneous']\nAnother agent identified the following named entities in the target sentence：<ner_label>\nHere provide some examples and the corresponding entity labels.\nThe helpfulness scores of each sentence are also provided, which indicates the degree to which providing the current example can aid in extracting named entities from the target_sentence.\nBased on the above information, recognize the named entities for the target sentence.\nSimply provide answer in the following format: [{\\\"Entity Name\\\": \\\"Entity Label\\\"}]. If there is no entity in the text, return the following empty list: []\n####\nSentence: His parents were encouraged by a friend to develop the child 's musical talents and he studied classical piano in the United States .\nLabel: [{'United States': 'Location'}]\nHelpfulness score: <score1>\n####\nSentence: In this , he is often cited as being influenced by pianist Eddy Duchin .\nLabel: [{'Eddy Duchin': 'Person'}]\nHelpfulness score: <score2>\n####\nSentence: In addition to a number of original songs , the album includes a cover of Siouxsie 's Cities in Dust .\nLabel: [{'Siouxsie': 'Person'}]\nHelpfulness score: <score3>\n####\nSentence: The album 's title is an amalgamation of the words ' digital ' and ' analogue ' , two of the principal technologies that have been used in sound recording .\nLabel: [{'digital': 'Miscellaneous'}, {'analogue': 'Miscellaneous'}]\nHelpfulness score: <score4>\n####\nSentence: The album cover 's artwork was provided by Mattias Noren .\nLabel: [{'Mattias Noren': 'Person'}]\nHelpfulness score: <score5>\n####\nSentence: Dark Room Notes are a four-piece electro / synthpop band based in Dublin , Ireland .\nLabel: [{'Dark Room Notes': 'Organization'}, {'Dublin': 'Location'}, {'Ireland': 'Location'}]\nHelpfulness score: <score6>\n####\nSentence: Darkness Death Doom is the sixth album by Runemagick .\nLabel: [{'Runemagick': 'Organization'}]\nHelpfulness score: <score7>\n####\nSentence: After his naval discharge , Langejans took a job at Meyer Music in Holland , where he was trained in the intricacies of instrument repair and electronics .\nLabel: [{'Langejans': 'Person'}, {'Meyer Music': 'Organization'}, {'Holland': 'Location'}]\nHelpfulness score: <score8>\n####\nSentence: The album was produced by Josh Abraham , whose producing credits also include Orgy , Velvet Revolver , and Linkin Park .\nLabel: [{'Josh Abraham': 'Person'}, {'Orgy': 'Organization'}, {'Velvet Revolver': 'Organization'}, {'Linkin Park': 'Organization'}]\nHelpfulness score: <score9>\n####\nSentence: The appearance of locomotive # 7 was permanently changed by replacement of a smaller number plate on the front of the boiler .\nLabel: [{'locomotive # 7': 'Miscellaneous'}]\nHelpfulness score: <score10>\n####\nSentence: Things began to speed up quickly , and Matt Wachter later joined the band as bassist and keyboard player .\nLabel: [{'Matt Wachter': 'Person'}]\nHelpfulness score: <score11>\n####\nSentence: In 1971 , he began to design and build his own guitars , originally bearing the name Del's .\nLabel: [{\"Del's\": 'Organization'}]\nHelpfulness score: <score12>\n####\nSentence: They were supported on this tour by Head Automatica , The Receiving End of Sirens , Cobra Starship , and several other bands including Street Drum Corps .\nLabel: [{'Head Automatica': 'Organization'}, {'The Receiving End of Sirens': 'Organization'}, {'Cobra Starship': 'Organization'}, {'Street Drum Corps': 'Organization'}]\nHelpfulness score: <score13>\n####\nSentence: As a young pianist , he toured Europe performing in many capitals .\nLabel: [{'Europe': 'Location'}]\nHelpfulness score: <score14>\n####\nSentence: According to an interview from Virgin Records , the band 's name\nLabel: [{'Virgin Records': 'Organization'}]\nHelpfulness score: <score15>\n####\nSentence: The Langejans Dualette is a two sided guitar which was custom made for Thom Bresh .\nLabel: [{'Langejans Dualette': 'Miscellaneous'}, {'Thom Bresh': 'Person'}]\nHelpfulness score: <score16>\n####\nSentence: UK Edition came with the OSC-DIS video , and most of the tracks were re-engineered .\nLabel:"
}
print('*' * 40)
print(c['stage1'])
print('=' * 40)
print(c['stage2'])
print('=' * 40)
print(c['stage3'])
print('*' * 40)


#
with open(
        'result/self_consistent_annotate/tb/wikigold/self_supervision/train_shuffle_42/fs_pool_std_c5_500_GPTEmbDvrsKNN_50_Sc/TIME_STAMP_st_std_c5_test__8_response_multistage.json',
        'r', encoding='utf-8') as file:
    # 2. 读取文件内容并解析为 Python 字典
    data = json.load(file)


def convert_to_list(list_str):
    try:
        return ast.literal_eval(list_str)
    except (SyntaxError, ValueError):
        try:
            preprocessed_str = list_str.replace('[', '["').replace(']', '"]').replace(', ', '", "')
            return ast.literal_eval(preprocessed_str)
        except (SyntaxError, ValueError) as e:
            print("转换错误:", e)
            return None


for d in data:
    my_list = convert_to_list(d['response1'])
    if my_list is None:
        continue
    not_list = []
    # print(my_list)
    for v in eval(d['label']).values():
        if v not in my_list:
            not_list.append(v)
    if len(not_list) != 0:
        print(d['sentence'])
        print(d['label'])
        print(not_list)
        print('-')
